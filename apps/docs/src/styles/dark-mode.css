/**
 * Dark Mode Polish
 * Comprehensive dark mode refinements and smooth transitions
 */

/* Enable smooth theme transitions */
[data-theme="light"],
[data-theme="dark"] {
  transition: background-color 200ms ease, color 200ms ease, border-color 200ms ease;
}

[data-theme="light"] *,
[data-theme="dark"] * {
  transition: background-color 200ms ease, color 200ms ease, border-color 200ms ease;
}

/* Disable transitions on page load */
html.no-transitions [data-theme="light"],
html.no-transitions [data-theme="dark"],
html.no-transitions [data-theme="light"] *,
html.no-transitions [data-theme="dark"] * {
  transition: none !important;
}

/* Dark mode specific refinements */
[data-theme="dark"] {
  color-scheme: dark;
}

[data-theme="light"] {
  color-scheme: light;
}

/* Enhanced contrast in dark mode */
[data-theme="dark"] body {
  background: var(--st-color-background);
  color: var(--st-color-text);
}

/* Code blocks in dark mode */
[data-theme="dark"] .code-block,
[data-theme="dark"] pre {
  background: var(--st-color-background);
  border-color: var(--st-color-border);
}

/* Tables in dark mode */
[data-theme="dark"] table {
  border-collapse: collapse;
}

[data-theme="dark"] table th {
  background: var(--st-color-surface);
  color: var(--st-color-text);
  border-color: var(--st-color-border);
}

[data-theme="dark"] table td {
  border-color: var(--st-color-border);
  background: var(--st-color-background);
}

[data-theme="dark"] table tbody tr:hover {
  background: var(--st-color-surface);
}

/* Links with better contrast in dark mode */
[data-theme="dark"] a {
  color: var(--st-color-primary);
}

[data-theme="dark"] a:visited {
  color: var(--st-color-primary);
}

[data-theme="dark"] a:hover {
  color: var(--st-color-primary);
  opacity: 0.9;
}

/* Buttons in dark mode */
[data-theme="dark"] button {
  transition: all 150ms cubic-bezier(0.2, 0, 0.38, 0.9);
}

/* Form inputs in dark mode */
[data-theme="dark"] input,
[data-theme="dark"] textarea,
[data-theme="dark"] select {
  background: var(--st-color-surface);
  color: var(--st-color-text);
  border-color: var(--st-color-border);
  transition: all 150ms cubic-bezier(0.2, 0, 0.38, 0.9);
}

[data-theme="dark"] input:focus,
[data-theme="dark"] textarea:focus,
[data-theme="dark"] select:focus {
  background: var(--st-color-surface-raised);
  border-color: var(--st-color-primary);
  outline: none;
}

/* Shadows in dark mode */
[data-theme="dark"] .shadow-sm {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .shadow-md {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .shadow-lg {
  box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
}

/* Selection styling in dark mode */
[data-theme="dark"] ::selection {
  background: var(--st-color-primary);
  color: white;
}

[data-theme="dark"] ::-moz-selection {
  background: var(--st-color-primary);
  color: white;
}

/* Scrollbar in dark mode */
[data-theme="dark"] ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

[data-theme="dark"] ::-webkit-scrollbar-track {
  background: transparent;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
  background: var(--st-color-border);
  border-radius: 4px;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb:hover {
  background: var(--st-color-text-muted);
}

/* Focus visible style refinement */
[data-theme="dark"] *:focus-visible {
  outline-color: var(--st-color-primary);
}

/* Placeholder text in dark mode */
[data-theme="dark"] ::placeholder {
  color: var(--st-color-text-muted);
  opacity: 0.6;
}

[data-theme="dark"] ::-webkit-input-placeholder {
  color: var(--st-color-text-muted);
  opacity: 0.6;
}

[data-theme="dark"] ::-moz-placeholder {
  color: var(--st-color-text-muted);
  opacity: 0.6;
}

/* Code syntax highlighting in dark mode - already in main CSS */
/* but we enhance with smooth transitions */
[data-theme="dark"] .token {
  transition: color 200ms ease;
}

/* Cards and surfaces */
[data-theme="dark"] .card,
[data-theme="dark"] [class*="card"] {
  background: var(--st-color-surface);
  border-color: var(--st-color-border);
  transition: all 150ms cubic-bezier(0.2, 0, 0.38, 0.9);
}

[data-theme="dark"] .card:hover,
[data-theme="dark"] [class*="card"]:hover {
  background: var(--st-color-surface-raised);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Improve readability for blockquotes */
[data-theme="dark"] blockquote {
  border-left-color: var(--st-color-primary);
  color: var(--st-color-text);
}

/* Better accessibility - ensure sufficient contrast */
[data-theme="dark"] :disabled {
  opacity: 0.5;
}

/* Smooth transitions for prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  [data-theme="light"],
  [data-theme="dark"],
  [data-theme="light"] *,
  [data-theme="dark"] * {
    transition: none !important;
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
  }
}
